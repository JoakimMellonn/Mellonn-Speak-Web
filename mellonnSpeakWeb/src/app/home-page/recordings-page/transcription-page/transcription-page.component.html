<div class="pageContainer">
    <div class="center">
        <div *ngIf="loading == true">
            Loading...
        </div>
        <div class="mainContent" *ngIf="loading == false">
            <div class="transcription">
                <div class="titleBox">
                    <h1>
                        {{ recording.name }}
                    </h1>
                    <div class="dropdown">
                        <i class="fa-solid fa-ellipsis-vertical fa-2xl icon"></i>
                        <div class="dropdown-content">
                            <a (click)="labelEditOpen = true">Edit labels</a>
                            <a (click)="downloadDOCX()">Download as DOCX</a>
                            <a (click)="versionHistoryOpen = true">Version history</a>
                            <a (click)="infoOpen = true">Info</a>
                            <a>Delete this recording</a>
                            <a>Help</a>
                        </div>
                    </div>
                </div>
                <div class="contentBox" *ngIf="!labelEditOpen && !versionHistoryOpen">
                    <div class="chatLine" *ngFor="let sww of speakerWithWords">
                        <div *ngIf="recording.interviewers?.includes(sww.speakerLabel)">
                            <app-user-chat-bubble [sww]="sww" [transcription]="transcription" [recording]="recording"></app-user-chat-bubble>
                            <p class="userText">{{ getSpkLabel(sww.speakerLabel) }} (Speaker {{getSpkNum(sww.speakerLabel) + 1}}): {{getTimeFrame(sww.startTime, sww.endTime)}}</p>
                        </div>
                        <div *ngIf="!recording.interviewers?.includes(sww.speakerLabel)">
                            <app-chat-bubble [sww]="sww" [isUser]="true" [transcription]="transcription" [recording]="recording"></app-chat-bubble>
                            <p class="text">{{ getSpkLabel(sww.speakerLabel) }} (Speaker {{getSpkNum(sww.speakerLabel) + 1}}): {{getTimeFrame(sww.startTime, sww.endTime)}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sideColumn">
                <div class="editTranscription">
                    <div class="titleBox">
                        <h1>
                            Edit transcription
                        </h1>
                    </div>
                    <div class="contentBox">
                        <button class="standardButton" (click)="resetAudio()">
                            Reset audio selection
                        </button><br><br>
                        <div *ngIf="!labelEditOpen">
                            <app-speaker-chooser [recording]="recording" [speakerWithWords]="speakerWithWords" [transcription]="transcription" *ngIf="loading == false"></app-speaker-chooser>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<app-audio-control *ngIf="loading == false"></app-audio-control>
<div class="modalBackgroundLabel" *ngIf="labelEditOpen && !loading">
    <div class="modalWindow">
        <app-label-edit [recording]="recording"></app-label-edit>
    </div>
</div>
<div class="modalBackground" *ngIf="versionHistoryOpen && !loading">
    <div class="modalWindow">
        <app-version-history [recording]="recording"></app-version-history>
        <button class="standardButton" (click)="versionHistoryOpen = false">Close</button>
    </div>
</div>
<div class="modalBackground" *ngIf="infoOpen" (click)="infoOpen = false">
    <div class="modalWindow">
        <app-info-panel [recording]="recording"></app-info-panel>
        <button class="standardButton">Close</button>
    </div>
</div>